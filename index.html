<!DOCTYPE html>
<html>
<head>
<title>Ethan Jacket Control</title>
<style>
  body {
    background-color:#111;
    color:#e0e0e0;
    font-family:'Cascadia Code',monospace;
    text-align:center;
  }
  h1 { margin-top:20px; color:#4CAF50; }

  button {
    padding:35px 65px;
    margin:20px;
    font-size:28px;
    border:none;
    border-radius:12px;
    cursor:pointer;
    color:white;
  }

  .red { background:red; }
  .green { background:green; }
  .blue { background:#007BFF; }
  .rainbow {
    background:linear-gradient(90deg,red,orange,yellow,green,blue,indigo,violet);
  }
  .off { background:#555; }

  input[type=range] {
    width:80%;
    margin-top:15px;
    -webkit-appearance:none;
    height:30px;
    background:#333;
    border-radius:15px;
    outline:none;
  }
  input[type=range]::-webkit-slider-thumb {
    -webkit-appearance:none;
    width:50px; height:50px;
    border-radius:50%;
    background:#4CAF50;
    cursor:pointer;
    margin-top:-10px;
  }

  #picker {
    display:block;
    margin:40px auto 10px auto;
    width:180px;
    height:120px;
  }

  .set {
    background:white;
    color:black;
    margin-top:5px;
    padding:25px 50px;
    font-size:26px;
    border-radius:12px;
    border:none;
    cursor:pointer;
  }
</style>
</head>
<body>

<h1>ESP LED Controller</h1>

<!-- ROW 1: Red / Green / Blue -->
<div>
  <button class="red" onclick="send('red')">Red</button>
  <button class="green" onclick="send('green')">Green</button>
  <button class="blue" onclick="send('blue')">Blue</button>
</div>

<!-- ROW 2: Rainbow + Speed slider -->
<div>
  <button class="rainbow" onclick="send('rainbow')">Rainbow</button>

  <input type="range" id="speed" min="1" max="100" value="60"
         oninput="updateSpeed(this.value)">
  <div style="font-size:22px;margin-top:10px;color:#4CAF50;">
    Animation Speed
  </div>
</div>

<!-- ROW 3: Color Picker -->
<div>
  <input type="color" id="picker" value="#ffffff">
  <button class="set" onclick="setColor()">Set Color</button>
</div>

<!-- ROW 4: Brightness -->
<div>
  <input type="range" id="bright" min="1" max="255" value="80"
         oninput="updateBrightness(this.value)">
  <div style="font-size:22px;margin-top:10px;color:#4CAF50;">
    Brightness
  </div>
</div>

<!-- ROW 5: OFF -->
<div>
  <button class="off" onclick="send('off')">Off</button>
</div>

<script>
const BASE = "https://ethansjacket-production.up.railway.app";

function send(cmd) {
  fetch(`${BASE}/set?cmd=${cmd}`)
    .catch(err => console.error("Error sending command", err));
}

function updateSpeed(v) {
  fetch(`${BASE}/set?cmd=rainbow&speed=${v}`)
    .catch(err => console.error("Error sending speed", err));
}

function updateBrightness(v) {
  fetch(`${BASE}/set?brightness=${v}&cmd=keep`)
    .catch(err => console.error("Error sending brightness", err));
}

function setColor() {
  const color = document.getElementById("picker").value.substring(1);
  const r = parseInt(color.substring(0,2), 16);
  const g = parseInt(color.substring(2,4), 16);
  const b = parseInt(color.substring(4,6), 16);

  fetch(`${BASE}/set?cmd=color&r=${r}&g=${g}&b=${b}`)
    .catch(err => console.error("Error sending color", err));
}
</script>

</body>
</html>
